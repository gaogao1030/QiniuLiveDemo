var YouYuChatUtil;YouYuChatUtil={template:function(t,e){var r;return r=t.html(),_.template(r)(e)},isVisitor:function(){var t;return t=["游客",""],-1!==_.indexOf(t,base.baseState.get("client_id"))?!0:!1},timeoutPromise:function(t,e){var r,n;return r=function(){return new AV.Promise(function(t){return setTimeout(t,e)})},n=r(e).then(function(){return Promise.reject(new Error("请求超时"))}),AV.Promise.race([t,n])},formatTime:function(t){var e;return e=new Date(t),$.format.date(e,"hh:mm:ss")},renderToPrintWall:function(t,e){var r;return r=this.elements.printWall,r.scrollTop(r[0].scrollHeight),e?$(t).insertBefore(r.children()[0]):r.append(t),this.scrollToBottomPrintWall()},showInfo:function(t){var e;return e=this.template(this.templates.showinfo,{msg:t}),this.renderToPrintWall(e)},showLog:function(t,e){var r;return r=this.template(this.templates.showlog,{msg:this.encodeHTML(t)}),this.renderToPrintWall(r,e)},encodeHTML:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},isEmptyString:function(t){return""!==String(t).replace(/^\s+/,"").replace(/\s+$/,"")?!1:!0},clearInput:function(){return this.elements.inputSend.val("")},scrollToBottomPrintWall:function(){var t;return t=this.elements.printWall,t.scrollTop(t[0].scrollHeight)},showMsg:function(t,e){var r,n,s,i;return i="",r=t.fromPeerId,n=r.split(":")[1],n=this.parseClientIdToName(n),i=t.msg.type?t.msg.text:t.msg,this.isEmptyString(i)?void 0:(s=this.template(this.templates.showmsg,{msg_time:this.formatTime(t.timestamp),from_name:this.encodeHTML(n),text:this.encodeHTML(i)}),this.renderToPrintWall(s,e))},showMyMsg:function(t,e,r){var n;return n=this.template(this.templates.showmymsg,{msg_time:this.formatTime(t.t),from_name:util.parseClientIdToName(base.baseState.get("client_id")),text:this.encodeHTML(e)}),this.renderToPrintWall(n,r)},showBroadCast:function(t,e){return util.renderToPrintWall(t.msg.text,e)},showSystemMsg:function(t,e){var r,n;return n=t.msg.type?t.msg.text:t.msg,r=this.template(this.templates.showsystemmsg,{text:n}),this.renderToPrintWall(r,e)},showChatLog:function(){var t,e;return t=base.baseState.get("log"),e=this.elements.printWall,_.each(t,function(t){return function(e){return"member"===t.parseMsgLevel(e)?t.showMsg(e,!0):t.showSystemMsg(e,!0)}}(this))},parseClientIdToName:function(t){var e,r,n;return n=base.baseState.get("white_list_open"),r=base.baseState.get("white_list"),n?(e=r[t],_.isUndefined(e)?t:e):t},refreshPage:function(t){return t.msg.attr.reload?window.location.reload():t.msg.attr.userReload===base.baseState.get("client_id")?window.location.reload():void 0},parseMsgLevel:function(t){return t.msg.attr.msgLevel},getKeyByValue:function(t,e){var r;return r=_.map(t,function(t,r){return t===e?r:void 0}),_.compact(r)[0]},inWhiteList:function(t){return _.has(base.baseState.get("white_list"),t)}};